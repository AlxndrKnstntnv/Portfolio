# Проект A/B-тестирования с применением метода CUPED

## Описание проекта

Этот проект посвящен анализу данных ритейл-сети с использованием A/B-тестирования для оценки влияния маркетингового вмешательства на поведение клиентов. В частности, мы рассматриваем изменение среднего объема трат в неделю среди клиентов после применения новой маркетинговой стратегии. Проект также включает применение метода **CUPED** (Controlled Pre-experiment Data), который позволяет улучшить точность теста за счет использования данных до вмешательства, что помогает снизить дисперсию в результатах, техник линеаризации, множественного тестирования и применения байесовских методов.

## Цели проекта

- Провести A/B-тест для оценки изменений в поведении клиентов после маркетингового вмешательства.
- Применить метод CUPED для повышения статистической мощности теста и уменьшения шума в данных.
- Оценить значимость изменений в среднем объеме покупок клиентов.
- Применить линеаризацию, множественное тестирование и байесовские методы.

## Данные

В проекте используются реальные данные по клиентам ритейл-сети. Набор данных, агрегированный для каждой недели, содержит следующую информацию:
- `client_id`: уникальный идентификатор клиента;
- `transaction_datetime`: дата транзакции;
- `sum_purchase`: сумма покупок клиента в данные сутки;

## Методология

### 1. **A/B-тестирование**

Мы проводим классический t-тест для проверки гипотезы о равенстве средних значений разницы в тратах между контрольной и экспериментальной группами:

- **Нулевая гипотеза (H₀)**: Средняя разница изменений трат между контрольной и экспериментальной группами равна.
- **Альтернативная гипотеза (H₁)**: Средняя разница изменений трат между контрольной и экспериментальной группами различается.

### 2. **Применение метода CUPED**

CUPED используется для учета данных до вмешательства и уменьшения дисперсии в результатах теста. Метод основывается на включении ковариаты (в данном случае объема покупок до эксперимента) и коррекции значений после вмешательства с ее помощью. Это повышает точность выводов и делает тест более чувствительным к реальным изменениям.

### Шаги применения CUPED:

1. Расчет средней суммы покупок до вмешательства для всей выборки.
2. Вычисление коэффициента корреляции β, который измеряет силу связи между покупками до и после эксперимента.
3. Корректировка итоговых значений с учетом полученной корреляции.
4. Проведение t-теста для скорректированных данных.

### 3. **Применение линеаризации для проведения тестов о соотношении AOV (Average Order Value)**

Линеаризация — это метод преобразования ratio-метрик (отношений), таких как средний чек в метрики аддитивные метрики, поддающиеся эффективному A/B-тестированию с новой метрикой, сонаправленной исходной.


### Шаги применения линеаризации:

1. Вычисляется значение метрики (в данном проекте AOV) на контрольной выборке.
2. Вычисляется сумма значений, лежащих в числителе метрики (недельная сумма трат) и в знаменателе (количество покупок).
3. Корректируется метрика для тестирования путем вычитания из числителя знаменателя, умноженного на среднее значение AOV по контрольной выборке.
4. Для контрольной и экспериментальной выборок проводится t-тест на сравнение средних исправленных метрик.

## Используемые библиотеки

- **Pandas** — для обработки данных.
- **SciPy** — для проведения статистических тестов.
- **NumPy** — для математических расчетов и работы с массивами данных.
- **Seaborn/Matplotlib** — визуализация.
- **Statsmodels** — для проведения множественнных тестов.

## Результаты и выводы

После проведения A/B-теста и применения метода CUPED, были получены следующие результаты:

- Без использования CUPED тест показал мощность 0.8 для выборок размера 1561 для 5-процентного уровня значимости, когда нашей задачей было обнаружение эффекта, равного 100 руб.
- После применения CUPED мы смогли увеличить мощность до 0.95 при исходных параметрах.
- Использовать достижения мы смогли для повышения чувствительности (до 75 руб.) или снижения требуемого размера выборки до 900.

## Заключение

Этот проект демонстрирует, как метод A/B-тестирования в сочетании с использованием методов корректировки, таких как CUPED, может повысить точность выводов о влиянии изменений на клиентское поведение. Проект может быть полезен аналитикам данных для разработки методов повышения чувствительности экспериментов и улучшения интерпретации результатов.
